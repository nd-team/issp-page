KISSY.add('kg/editor-plugins/1.1.2/flash/dialog',["util","editor","../flash-common/utils","../dialog","../menubutton"],function(S ,require, exports, module) {function t(t,e){var l=this;l.editor=t,l.config=e||{},i.Utils.lazyRun(l,"_prepareShow","_realShow"),l._config()}var e=require("util"),i=require("editor"),l=require("../flash-common/utils"),a=require("../dialog"),r=require("../menubutton"),s="ke_flash",n="flash",d="请输入如 http://www.xxx.com/xxx.swf",o='<div style="padding:20px 20px 0 20px"><p><label>网址： <input  data-verify="^https?://[^\\s]+$"  data-warning="网址格式为：http://" class="{prefixCls}editor-flash-url {prefixCls}editor-input" style="width:300px;" /></label></p><table style="margin:10px 0 5px  40px;width:300px;"><tr><td><label>宽度： <input  data-verify="^(?!0$)\\d+$"  data-warning="宽度请输入正整数" class="{prefixCls}editor-flash-width {prefixCls}editor-input" style="width:60px;" /> 像素 </label></td><td><label>高度： <input  data-verify="^(?!0$)\\d+$"  data-warning="高度请输入正整数" class="{prefixCls}editor-flash-height {prefixCls}editor-input" style="width:60px;" /> 像素 </label></td></tr><tr><td><label>对齐： </label><select class="{prefixCls}editor-flash-align" title="对齐"><option value="none">无</option><option value="left">左对齐</option><option value="right">右对齐</option></select></td><td><label>间距： </label><input  data-verify="^\\d+$"  data-warning="间距请输入非负整数" class="{prefixCls}editor-flash-margin {prefixCls}editor-input" style="width:60px;" value="5"/> 像素</td></tr></table></div>',h='<div style="padding:10px 0 35px 20px;"><a class="{prefixCls}editor-flash-ok {prefixCls}editor-button ks-inline-block" style="margin-left:40px;margin-right:20px;">确定</a> <a class="{prefixCls}editor-flash-cancel {prefixCls}editor-button ks-inline-block">取消</a></div>';e.augment(t,{addRes:i.Utils.addRes,destroyRes:i.Utils.destroyRes,_config:function(){var t=this,i=t.editor,l=i.get("prefixCls");t._urlTip=d,t._type=n,t._cls=s,t._configDWidth="400px",t._title="Flash",t._bodyHTML=e.substitute(o,{prefixCls:l}),t._footHTML=e.substitute(h,{prefixCls:l})},_prepareShow:function(){var t=this;t.dialog=new a({headerContent:t._title,bodyContent:t._bodyHTML,footerContent:t._footHTML,width:t._configDWidth||"500px",mask:!0}).render(),t.addRes(t.dialog),t._initD()},_realShow:function(){this._updateD(),this.dialog.show()},_getFlashUrl:function(t){return l.getUrl(t)},_updateD:function(){var t=this,e=t.editor,l=t.config,a=t.selectedFlash;if(a){var r=e.restoreRealElement(a);if(!r)return;a.css("width")&&t.dWidth.val(parseInt(a.css("width"),10)),a.css("height")&&t.dHeight.val(parseInt(a.css("height"),10)),t.dAlign.set("value",a.css("float")),i.Utils.valInput(t.dUrl,t._getFlashUrl(r)),t.dMargin.val(parseInt(r.style("margin"),10)||0)}else i.Utils.resetInput(t.dUrl),t.dWidth.val(l.defaultWidth||""),t.dHeight.val(l.defaultHeight||""),t.dAlign.set("value","none"),t.dMargin.val("5")},show:function(t){var e=this;e.selectedFlash=t,e._prepareShow()},_initD:function(){var t=this,e=t.dialog,l=t.editor,a=l.get("prefixCls"),s=e.get("el");t.dHeight=s.one("."+a+"editor-flash-height"),t.dWidth=s.one("."+a+"editor-flash-width"),t.dUrl=s.one("."+a+"editor-flash-url"),t.dAlign=r.Select.decorate(s.one("."+a+"editor-flash-align"),{prefixCls:a+"editor-big-",width:80,menuCfg:{prefixCls:a+"editor-",render:s}}),t.dMargin=s.one("."+a+"editor-flash-margin");var n=s.one("."+a+"editor-flash-ok"),d=s.one("."+a+"editor-flash-cancel");n.on("click",t._gen,t),d.on("click",function(t){e.hide(),t.halt()}),i.Utils.placeholder(t.dUrl,t._urlTip),t.addRes(t.dAlign)},_getDInfo:function(){var t=this;return{url:t.dUrl.val(),attrs:{width:t.dWidth.val(),height:t.dHeight.val(),style:"margin:"+(parseInt(t.dMargin.val(),10)||0)+"px;float:"+t.dAlign.get("value")+";"}}},_gen:function(t){t&&t.halt();var a=this,r=a.editor,s=a._getDInfo(),n=s&&e.trim(s.url),d=s&&s.attrs;if(s){var o=i.Utils.verifyInputs(a.dialog.get("el").all("input"));if(o){a.dialog.hide();var h=l.insertFlash(r,n,d,a._cls,a._type);a.selectedFlash&&r.getSelection().selectElement(h),r.notifySelectionChange()}}},destroy:function(){this.destroyRes()}}),module.exports=t;});